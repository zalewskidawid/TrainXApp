(function(e){function t(t){for(var c,s,r=t[0],i=t[1],u=t[2],d=0,l=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&l.push(a[s][0]),a[s]=0;for(c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c]);h&&h(t);while(l.length)l.shift()();return n.push.apply(n,u||[]),o()}function o(){for(var e,t=0;t<n.length;t++){for(var o=n[t],c=!0,s=1;s<o.length;s++){var r=o[s];0!==a[r]&&(c=!1)}c&&(n.splice(t--,1),e=i(i.s=o[0]))}return e}var c={},s={app:0},a={app:0},n=[];function r(e){return i.p+"js/"+({}[e]||e)+"."+{"chunk-2d0c94ec":"8e40fc2e","chunk-33dec5b7":"88050ba7","chunk-4fa4dc02":"ececc32a","chunk-7da3744c":"efb50a57","chunk-9c52731a":"298c62e4","chunk-e4c2b18c":"b5db5d73"}[e]+".js"}function i(t){if(c[t])return c[t].exports;var o=c[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.e=function(e){var t=[],o={"chunk-33dec5b7":1,"chunk-4fa4dc02":1,"chunk-7da3744c":1,"chunk-9c52731a":1,"chunk-e4c2b18c":1};s[e]?t.push(s[e]):0!==s[e]&&o[e]&&t.push(s[e]=new Promise((function(t,o){for(var c="css/"+({}[e]||e)+"."+{"chunk-2d0c94ec":"31d6cfe0","chunk-33dec5b7":"af76c2ea","chunk-4fa4dc02":"749b21fd","chunk-7da3744c":"e4234e82","chunk-9c52731a":"72e2b819","chunk-e4c2b18c":"447c5e00"}[e]+".css",a=i.p+c,n=document.getElementsByTagName("link"),r=0;r<n.length;r++){var u=n[r],d=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(d===c||d===a))return t()}var l=document.getElementsByTagName("style");for(r=0;r<l.length;r++){u=l[r],d=u.getAttribute("data-href");if(d===c||d===a)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var c=t&&t.target&&t.target.src||a,n=new Error("Loading CSS chunk "+e+" failed.\n("+c+")");n.code="CSS_CHUNK_LOAD_FAILED",n.request=c,delete s[e],h.parentNode.removeChild(h),o(n)},h.href=a;var b=document.getElementsByTagName("head")[0];b.appendChild(h)})).then((function(){s[e]=0})));var c=a[e];if(0!==c)if(c)t.push(c[2]);else{var n=new Promise((function(t,o){c=a[e]=[t,o]}));t.push(c[2]=n);var u,d=document.createElement("script");d.charset="utf-8",d.timeout=120,i.nc&&d.setAttribute("nonce",i.nc),d.src=r(e);var l=new Error;u=function(t){d.onerror=d.onload=null,clearTimeout(h);var o=a[e];if(0!==o){if(o){var c=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+c+": "+s+")",l.name="ChunkLoadError",l.type=c,l.request=s,o[1](l)}a[e]=void 0}};var h=setTimeout((function(){u({type:"timeout",target:d})}),12e4);d.onerror=d.onload=u,document.head.appendChild(d)}return Promise.all(t)},i.m=e,i.c=c,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)i.d(o,c,function(t){return e[t]}.bind(null,c));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/TrainXApp/",i.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],d=u.push.bind(u);u.push=t,u=u.slice();for(var l=0;l<u.length;l++)t(u[l]);var h=d;n.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"01e1":function(e,t,o){},"1d52":function(e,t,o){},"385e":function(e,t,o){},"3b42":function(e,t,o){"use strict";o("385e")},"3b5d":function(e,t,o){},"3ec8":function(e,t,o){"use strict";o("cf1f")},"40b8":function(e,t,o){"use strict";o("1d52")},"4cc9":function(e,t,o){"use strict";o("d8e2")},5620:function(e,t,o){"use strict";o("01e1")},"56d7":function(e,t,o){"use strict";o.r(t);var c=o("7a23"),s=o("6605");const a={class:"controls"},n={key:0},r={key:1},i={key:2};function u(e,t,o,s,u,d){const l=Object(c["E"])("base-dialog"),h=Object(c["E"])("base-button"),b=Object(c["E"])("base-spinner"),p=Object(c["E"])("coach-item"),f=Object(c["E"])("base-card");return Object(c["w"])(),Object(c["h"])("div",null,[Object(c["k"])(l,{show:!!u.error,title:"An error occurred!",onClose:d.handleError},{default:Object(c["N"])(()=>[Object(c["i"])("p",null,Object(c["H"])(u.error),1)]),_:1},8,["show","onClose"]),Object(c["i"])("section",null,[Object(c["k"])(f,null,{default:Object(c["N"])(()=>[Object(c["i"])("div",a,[Object(c["k"])(h,{mode:"outline",onClick:t[0]||(t[0]=e=>d.loadCoaches(!0))},{default:Object(c["N"])(()=>[Object(c["j"])("Refresh")]),_:1})]),u.isLoading?(Object(c["w"])(),Object(c["h"])("div",n,[Object(c["k"])(b)])):d.hasCoaches?(Object(c["w"])(),Object(c["h"])("ul",r,[(Object(c["w"])(!0),Object(c["h"])(c["a"],null,Object(c["C"])(d.returnCoaches,e=>(Object(c["w"])(),Object(c["f"])(p,{id:e.id,"first-name":e.firstName,"last-name":e.lastName,rate:e.hourlyRate,email:e.email,userType:e.userType,key:e.id},null,8,["id","first-name","last-name","rate","email","userType"]))),128))])):(Object(c["w"])(),Object(c["h"])("h3",i,"No coaches found."))]),_:1})])])}const d={class:"actions"};function l(e,t,o,s,a,n){const r=Object(c["E"])("base-button");return Object(c["w"])(),Object(c["h"])("li",null,[Object(c["i"])("p",null,Object(c["H"])(n.fullName),1),Object(c["i"])("p",null,Object(c["H"])(n.rateDisplay),1),Object(c["i"])("p",null,Object(c["H"])(o.userType),1),Object(c["i"])("div",d,[Object(c["k"])(r,{mode:"outline",link:"",to:n.coachContactLink},{default:Object(c["N"])(()=>[Object(c["j"])("Contact")]),_:1},8,["to"]),Object(c["k"])(r,{link:"",to:n.coachDetailsLink},{default:Object(c["N"])(()=>[Object(c["j"])("View Details")]),_:1},8,["to"])])])}var h={props:["userType","firstName","lastName","rate","id"],computed:{coachContactLink(){return this.$route.path+"/"+this.id+"/contact"},coachDetailsLink(){return this.$route.path+"/"+this.id},fullName(){return this.firstName+" "+this.lastName},rateDisplay(){return this.rate+"zł/h"}}},b=(o("3b42"),o("6b0d")),p=o.n(b);const f=p()(h,[["render",l],["__scopeId","data-v-0aa9b5f9"]]);var m=f,j={components:{CoachItem:m},data(){return{isLoading:!1,error:null}},computed:{returnCoaches(){const e=this.$store.getters["coaches/coaches"];return e},isLoggedIn(){return this.$store.getters.isAuthenticated},hasCoaches(){return!this.isLoading&&this.$store.getters["coaches/hasCoaches"]}},created(){this.loadCoaches()},methods:{async loadCoaches(e=!1){this.isLoading=!0;try{await this.$store.dispatch("coaches/loadCoaches",{forceRefresh:e})}catch(t){this.error=t.message||"Something went wrong!"}this.isLoading=!1},handleError(){this.error=null}}};o("d7f9");const O=p()(j,[["render",u],["__scopeId","data-v-fe04f8ca"]]);var g=O;const k=Object(c["i"])("h2",null,"Page not found",-1);function y(e,t){const o=Object(c["E"])("router-link"),s=Object(c["E"])("base-card");return Object(c["w"])(),Object(c["h"])("section",null,[Object(c["k"])(s,null,{default:Object(c["N"])(()=>[k,Object(c["i"])("p",null,[Object(c["j"])(" This page could not be found - maybe check out all our "),Object(c["k"])(o,{to:"/coaches"},{default:Object(c["N"])(()=>[Object(c["j"])("coaches")]),_:1}),Object(c["j"])(". ")])]),_:1})])}const v={},w=p()(v,[["render",y]]);var I=w,N=o("5502"),C=(o("14d9"),{registerCoach(e,t){e.coaches.push(t)},setCoaches(e,t){e.coaches=t},setFetchTimestamp(e){e.lastFetch=(new Date).getTime()}}),E=(o("d9e2"),{async registerCoach(e,t){const o=e.rootGetters.userId,c={firstName:t.first,lastName:t.last,description:t.desc,hourlyRate:t.rate,areas:t.areas},s=e.rootGetters.token,a=await fetch(`https://trainx-app-default-rtdb.europe-west1.firebasedatabase.app/${o}.json?auth=`+s,{method:"PUT",body:JSON.stringify(c)});a.ok,e.commit("registerCoach",{...c,id:o})},async loadCoaches(e,t){if(!t.forceRefresh&&!e.getters.shouldUpdate)return;const o=await fetch("https://trainx-app-default-rtdb.europe-west1.firebasedatabase.app/trainers.json"),c=await o.json();if(!o.ok){const e=new Error(c.message||"Failed to fetch!");throw e}const s=[];for(const a in c){const e={id:a,firstName:c[a].firstName,lastName:c[a].lastName,description:c[a].description,hourlyRate:c[a].rate,email:c[a].email,userType:c[a].userType};s.push(e)}e.commit("setCoaches",s),e.commit("setFetchTimestamp")},async LoadSpecificCoach(e){const t=await fetch("https://trainx-app-default-rtdb.europe-west1.firebasedatabase.app/trainers.json"),o=await t.json();if(!t.ok){const e=new Error(o.message||"Failed to fetch!");throw e}const c=[];for(const s in o){const e={id:s,firstName:o[s].firstName,lastName:o[s].lastName,description:o[s].description,hourlyRate:o[s].rate,email:o[s].email,userType:o[s].userType};c.push(e)}e.commit("setCoaches",c)}}),_={coaches(e){return e.coaches},hasCoaches(e){return e.coaches&&e.coaches.length>0},shouldUpdate(e){const t=e.lastFetch;if(!t)return!0;const o=(new Date).getTime();return(o-t)/1e3>60}},T={namespaced:!0,state(){return{lastFetch:null,coaches:[]}},mutations:C,actions:E,getters:_},L={addRequest(e,t){e.requests.push(t)},setRequests(e,t){e.requests=t}},A={async contactCoach(e,t){const o=e.rootGetters.userId,c={userEmail:t.email,message:t.message,userIdAddress:o,userIdRecipient:t.coachId},s=await fetch(`https://trainx-app-default-rtdb.europe-west1.firebasedatabase.app/requests/${o+t.coachId}.json`,{method:"PUT",body:JSON.stringify(c)}),a=await s.json();if(!s.ok){const e=new Error(a.message||"Nie udało się wysłać zapytania.");throw e}e.commit("addRequest",c)},async fetchRequests(e){const t=e.rootGetters.userId,o=e.rootGetters.token,c=await fetch("https://trainx-app-default-rtdb.europe-west1.firebasedatabase.app/requests.json?auth="+o),s=await c.json();if(!c.ok){const e=new Error(s.message||"Failed to fetch requests.");throw e}const a=[];for(const n in s){const e={userIdRecipient:s[n].userIdRecipient,userIdAddress:s[n].userIdAddress,userEmail:s[n].userEmail,message:s[n].message};t!==e.userIdAddress&&t!==e.userIdRecipient||a.push(e)}e.commit("setRequests",a)}},q={requests(e){return e.requests},hasRequests(e,t){return t.requests&&t.requests.length>0}},S={namespaced:!0,state(){return{requests:[]}},mutations:L,actions:A,getters:q},x={setUser(e,t){e.token=t.token,e.userId=t.userId,e.didAutoLogout=!1},setAutoLogout(e){e.didAutoLogout=!0}};let $;var P={async login(e,t){return e.dispatch("auth",{...t,mode:"login"})},async signup(e,t){return e.dispatch("auth",{...t,mode:"signup"})},async auth(e,t){const o=t.mode,c=t.userType;let s="",a="https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyC7sDufCs5on6nIJG3GGOPi9MZrtlVBp2E";"signup"===o&&(a="https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyC7sDufCs5on6nIJG3GGOPi9MZrtlVBp2E");const n=await fetch(a,{method:"POST",body:JSON.stringify({email:t.email,password:t.password,returnSecureToken:!0})}),r=await n.json();if("signup"===o){const e=await n.json(),o=e.localId;s="client"===c?`https://trainx-app-default-rtdb.europe-west1.firebasedatabase.app/clients/${o}.json`:`https://trainx-app-default-rtdb.europe-west1.firebasedatabase.app/trainers/${o}.json`;const a=await fetch(s,{method:"PUT",body:JSON.stringify({email:t.email,userType:c,userId:o,firstName:t.first,lastName:t.last,description:t.desc,rate:t.rate})});if(!n.ok||!a.ok){const t=new Error(e.message||"Failed to authenticate. Check your login data.");throw t}}const i=1e3*+r.expiresIn,u=(new Date).getTime()+i;localStorage.setItem("token",r.idToken),localStorage.setItem("userId",r.localId),localStorage.setItem("tokenExpiration",u),$=setTimeout((function(){e.dispatch("autoLogout")}),i),e.commit("setUser",{token:r.idToken,userId:r.localId})},tryLogin(e){const t=localStorage.getItem("token"),o=localStorage.getItem("userId"),c=localStorage.getItem("tokenExpiration"),s=+c-(new Date).getTime();s<0||($=setTimeout((function(){e.dispatch("autoLogout")}),s),t&&o&&e.commit("setUser",{token:t,userId:o}))},logout(e){localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("tokenExpiration"),clearTimeout($),e.commit("setUser",{token:null,userId:null})},autoLogout(e){e.dispatch("logout"),e.commit("setAutoLogout")}},R={userId(e){return e.userId},token(e){return e.token},isAuthenticated(e){return!!e.token},didAutoLogout(e){return e.didAutoLogout}},D={state(){return{userId:null,token:null,didAutoLogout:!1}},mutations:x,actions:P,getters:R};const U=Object(N["a"])({modules:{coaches:T,requests:S,auth:D}});var F=U;const G=Object(c["l"])(()=>o.e("chunk-2d0c94ec").then(o.bind(null,"591c"))),J=Object(c["l"])(()=>o.e("chunk-e4c2b18c").then(o.bind(null,"f7b3"))),H=Object(c["l"])(()=>o.e("chunk-7da3744c").then(o.bind(null,"a980"))),B=Object(c["l"])(()=>o.e("chunk-9c52731a").then(o.bind(null,"416f"))),M=Object(c["l"])(()=>o.e("chunk-4fa4dc02").then(o.bind(null,"212c"))),z=Object(s["a"])({history:Object(s["b"])(),routes:[{path:"/",redirect:"/coaches"},{path:"/coaches",component:g},{path:"/coaches/:id",component:G,props:!0,children:[{path:"contact",component:H}]},{path:"/register",component:J,meta:{requiresAuth:!0}},{path:"/requests",component:B,meta:{requiresAuth:!0}},{path:"/auth",component:M,meta:{requiresUnauth:!0}},{path:"/:notFound(.*)",component:I}]});z.beforeEach((function(e,t,o){e.meta.requiresAuth&&!F.getters.isAuthenticated?o("/auth"):e.meta.requiresUnauth&&F.getters.isAuthenticated?o("/coaches"):o()}));var V=z;function Z(e,t,o,s,a,n){const r=Object(c["E"])("the-header"),i=Object(c["E"])("router-view");return Object(c["w"])(),Object(c["h"])(c["a"],null,[Object(c["k"])(r),Object(c["k"])(i,null,{default:Object(c["N"])(e=>[Object(c["k"])(c["c"],{name:"route",mode:"out-in"},{default:Object(c["N"])(()=>[(Object(c["w"])(),Object(c["f"])(Object(c["F"])(e.Component)))]),_:2},1024)]),_:1})],64)}const K={key:0},W={key:1},X={key:2};function Q(e,t,o,s,a,n){const r=Object(c["E"])("router-link"),i=Object(c["E"])("base-button");return Object(c["w"])(),Object(c["h"])("header",null,[Object(c["i"])("nav",null,[Object(c["i"])("h1",null,[Object(c["k"])(r,{to:"/"},{default:Object(c["N"])(()=>[Object(c["j"])("Find a Coach")]),_:1})]),Object(c["i"])("ul",null,[Object(c["i"])("li",null,[Object(c["k"])(r,{to:"/coaches"},{default:Object(c["N"])(()=>[Object(c["j"])("All Coaches")]),_:1})]),n.isLoggedIn?(Object(c["w"])(),Object(c["h"])("li",K,[Object(c["k"])(r,{to:"/requests"},{default:Object(c["N"])(()=>[Object(c["j"])("Requests")]),_:1})])):(Object(c["w"])(),Object(c["h"])("li",W,[Object(c["k"])(r,{to:"/auth"},{default:Object(c["N"])(()=>[Object(c["j"])("Login")]),_:1})])),n.isLoggedIn?(Object(c["w"])(),Object(c["h"])("li",X,[Object(c["k"])(i,{onClick:n.logout},{default:Object(c["N"])(()=>[Object(c["j"])("Logout")]),_:1},8,["onClick"])])):Object(c["g"])("",!0)])])])}var Y={computed:{isLoggedIn(){return this.$store.getters.isAuthenticated}},methods:{logout(){this.$store.dispatch("logout"),this.$router.replace("/coaches")}}};o("5620");const ee=p()(Y,[["render",Q],["__scopeId","data-v-6a38bc36"]]);var te=ee,oe={components:{TheHeader:te},computed:{didAutoLogout(){return this.$store.getters.didAutoLogout}},created(){this.$store.dispatch("tryLogin")},watch:{didAutoLogout(e,t){e&&e!==t&&this.$router.replace("/coaches")}}};o("40b8");const ce=p()(oe,[["render",Z]]);var se=ce;const ae={class:"card"};function ne(e,t){return Object(c["w"])(),Object(c["h"])("div",ae,[Object(c["D"])(e.$slots,"default",{},void 0,!0)])}o("4cc9");const re={},ie=p()(re,[["render",ne],["__scopeId","data-v-1f9750d9"]]);var ue=ie;function de(e,t,o,s,a,n){const r=Object(c["E"])("router-link");return o.link?(Object(c["w"])(),Object(c["f"])(r,{key:1,to:o.to,class:Object(c["s"])(o.mode)},{default:Object(c["N"])(()=>[Object(c["D"])(e.$slots,"default",{},void 0,!0)]),_:3},8,["to","class"])):(Object(c["w"])(),Object(c["h"])("button",{key:0,class:Object(c["s"])(o.mode)},[Object(c["D"])(e.$slots,"default",{},void 0,!0)],2))}var le={props:{mode:{type:String,required:!1,default:null},link:{type:Boolean,required:!1,default:!1},to:{type:String,required:!1,default:"/"}}};o("cf4d");const he=p()(le,[["render",de],["__scopeId","data-v-2b151212"]]);var be=he;function pe(e,t,o,s,a,n){return Object(c["w"])(),Object(c["h"])("span",{class:Object(c["s"])(["badge",o.type])},Object(c["H"])(n.text),3)}var fe={props:["type","title"],computed:{text(){return this.title.toUpperCase()}}};o("b997");const me=p()(fe,[["render",pe],["__scopeId","data-v-5de3df1c"]]);var je=me;const Oe=e=>(Object(c["z"])("data-v-5147169a"),e=e(),Object(c["x"])(),e),ge={class:"spinner"},ke=Oe(()=>Object(c["i"])("div",{class:"lds-roller"},[Object(c["i"])("div"),Object(c["i"])("div"),Object(c["i"])("div"),Object(c["i"])("div"),Object(c["i"])("div"),Object(c["i"])("div"),Object(c["i"])("div"),Object(c["i"])("div")],-1)),ye=[ke];function ve(e,t){return Object(c["w"])(),Object(c["h"])("div",ge,ye)}o("3ec8");const we={},Ie=p()(we,[["render",ve],["__scopeId","data-v-5147169a"]]);var Ne=Ie;const Ce=Object(c["l"])(()=>o.e("chunk-33dec5b7").then(o.bind(null,"ae92"))),Ee=Object(c["e"])(se);Ee.use(V),Ee.use(F),Ee.component("base-card",ue),Ee.component("base-button",be),Ee.component("base-badge",je),Ee.component("base-spinner",Ne),Ee.component("base-dialog",Ce),Ee.mount("#app")},"9c3e":function(e,t,o){},b997:function(e,t,o){"use strict";o("9c3e")},cf1f:function(e,t,o){},cf4d:function(e,t,o){"use strict";o("3b5d")},d7f9:function(e,t,o){"use strict";o("da90")},d8e2:function(e,t,o){},da90:function(e,t,o){}});
//# sourceMappingURL=app.da76f33a.js.map